風来のシレン外伝 女剣士アスカ見参！プレイ環境改善ツール "AsukaLib"

◆導入することで追加される機能

○CPUの負荷低減
　アスカはウィンドウをアクティブにするとタスクをほぼ完全に独り占めにして
　CPUに大きな負荷をかけてしまう仕様ですが、適切なウェイトを挟むことで
　CPU負荷をある程度（10〜80%程）低減させます。

○非アクティブでも描画継続
　アスカはウィンドウが非アクティブ状態になると描画・サウンドが停止してしまいますが、
　非アクティブ状態でも描画・サウンドを継続させます。

○サウンドのボリューム調整機能
　BGM・SEのボリュームをそれぞれ任意の値に変更できます。

○ウィンドウサイズ調整機能
　設定によりウィンドウのサイズを任意に調整できます。
　また、アスカのウィンドウサイズと位置を記憶し、
　次回起動時に自動的にウィンドウサイズと位置を復元します。

◆使い方

　AsukaLib.dllをd3d8.dllとリネームして、
　風来のシレン外伝 女剣士アスカ見参！のインストールフォルダに置いて下さい。
　※絶対にシステムフォルダにはコピーしないで下さい※
　そのままアスカを起動させると連動してAsukaLibが立ち上がります。
　起動に成功するとウィンドウタイトルが変わり、
　現在のプライオリティ(プログラム実行優先度)・ウェイトタイム(↑で書いてあるウェイト)・
　BGMボリューム・SEボリュームが表示されます。
　プライオリティはCTRL+↑or↓キーで、ウェイトタイムはCTRL+SHIFT+↑or↓キーで、
　BGMボリュームはCTRL+PAGEUPorPAGEDOWNキーで、SEボリュームはCTRL+SHIFT+PAGEUPorPAGEDOWNキーで変更できます。
　またゲーム画面を右クリックするとメニューが開くようになります。
　設定ロックは現在の設定を維持し、↑のショートカットキーでは変更できないようにします。
　BGM・SEミュートそれぞれ名前通りの機能です。いずれもon/offをクリックで切り替えます。
　プライオリティはIdle, Normal, High, RealTimeがあります。後者に行くほど優先度が高い事になります。
　負荷調整はウェイトタイムを調整した方が安全かつ確実なので、通常はNormalから変更する必要はありません。
　ウェイトタイムは描画の合間に挟むウェイト時間（単位はms）を表します。1ms単位で調整が可能です。
　デフォルトは10msです。作者の環境では10msの状態でのCPU使用率は40〜50%でした。
　BGM・SEボリュームはそれぞれシステム上の理由からデフォルト値で最大になっています。
　環境設定ではプライオリティ・ウェイト・ボリュームと描画、サウンドの継続設定を行えます。

◆設定ファイルについて

　AsukaLibが終了すると、設定した情報はAsukaLib.iniに記録されます。
　AsukaLib.iniがカレントディレクトリ（つまりアスカのインストールディレクトリ）にある状態で
　プログラムを起動すると、AsukaLibはIniファイルから設定情報を読み込みます。
　設定ファイルの設定項目が無かったり、値が想定外であったり、設定ファイルが無かった場合は
　AsukaLibはその設定項目に関してはデフォルト値を適用します。

◆注意事項

　AsukaLibは無保証です。
　このソフトを使用した事によるあらゆる損害に対して作者は責任を負いません。

◆ＦＡＱ

○動かない
　かなり強引なフックを用いているので、環境によってはプログラム自体が動かない可能性があります。
　というか動かない環境の方が多いかも知れません。特にWin9x系では動かない可能性大です。

○起動は成功してる筈なのに動かない
　9x系ではDirect3D(描画系)のフックは成功してもDirectInput(入力系)・DirectSound(サウンド系)の
　フックが失敗するために、ウィンドウタイトルが変更(＝Direct3Dのフックが成功)しても、
　BGM・SEの入力調整が出来ない場合があります。これは前者と後者でフックの形態が違う為です。
　この場合DirectInputの入力抑制が効かないので、非アクティブ時でもアスカに入力が行ってしまうバグが
　発現します。

◆現バージョンまでで既知のバグ

　○警報スイッチのSEがBGM扱いの音量となっている。

◆謝辞

　プログラムの作成に当たってsaw氏(http://saw.minidns.net/)のプログラムソースを参考にさせて頂きました。
　この場を借りてお礼申し上げます。

◆更新履歴

2007 03/07 Ver 0.0.1	・ファーストリリース。
2007 03/10 Ver 0.0.2	・DirectSoundに対応。
			・ウェイトの調整単位を10msから5msに。
2007 03/11 Ver 0.0.3	・BGM・SEをそれぞれ音量調整できるように。
			・設定ロック機能を追加。
2007 03/14 Ver 0.0.4	・ソース上の不必要な関数定義をコメントアウト。
			・DirectInputにもウェイトを挟む事でウェイトによるCPU負荷軽減パフォーマンスを向上。
			・非アクティブ時にDirectSoundを使っている他のウィンドウにフォーカスを移すと
			　再生が止まるバグを修正。
			・ボリュームを最低値まで下げても微妙に音が聞こえる場合があるバグを修正。
			・設定の変更幅を調整。
2007 03/19 Ver 0.0.5	・ウェイト分散によるパフォーマンス向上が今一疑問だったので取り戻し。
			・環境設定実装。
			・設定情報をIniで保持するように。
			・描画、サウンドの継続を設定可能に（サウンドは擬似的な実装）。
2008 12/17 Ver 0.0.6	・レベルアップ音がBGM属性になっていたバグ修正。
2008 12/18 Ver 0.0.7	・ウィンドウサイズ調整機能を実装。
2008 12/18 Ver 0.0.7.1	・0.0.6でのエンバグ修正。バージョンリソース修正。
2009 01/30 Ver 0.0.7.2	・0.0.6でのエンバグ再修正。
			・ウィンドウを切り替えるだけで画面全体がちらつくバグ修正。
2009 02/21 Ver 0.0.8	・アスペクト比を固定したまま拡大する機能追加。
			・ウィンドウ境界でのサイズ変更カーソルをエミュレート。
			・その他ウィンドウ制御関係の細かい修正。
2012 04/01 Ver 0.0.8    ・github公開にあたってちょこっとソースリファクタリング。
